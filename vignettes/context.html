<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Rich FitzJohn" />

<meta name="date" content="2015-11-05" />

<title>context</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">context</h1>
<h4 class="author"><em>Rich FitzJohn</em></h4>
<h4 class="date"><em>2015-11-05</em></h4>
</div>


<p>The idea here is that we want to describe how to build a “context” and then evalute one or more expressions in it. This is a little related to approaches like <code>docker</code> and <code>packrat</code> in that we want contexts to be isolated from one another, but different in that <em>portability</em> is more important than isolation.</p>
<p>Imagine that you have an analysis to run on another computer with:</p>
<ul>
<li>packages to install from CRAN or any one of several other R package repositories (e.g., a <code>drat</code>, bioconductor, etc).</li>
<li>packages to install from github</li>
<li>packages to install from local sources (e.g., private github repos, unrelesed code)</li>
<li>A number of source files to read in</li>
<li>A local environment to recreate (e.g., if calling a function from another function).</li>
</ul>
<p>The other computer may already have some packages installed, so you don’t want to waste time and bandwidth re-installing them. So things end up littered with constructs like</p>
<pre class="sourceCode r"><code class="sourceCode r">if (!<span class="kw">require</span>(<span class="st">&quot;mypkg&quot;</span>)) {
   <span class="kw">install.packages</span>(<span class="st">&quot;mypkg&quot;</span>)
   <span class="kw">library</span>(mypkg)
}</code></pre>
<p>If these packages are coming from github (or worse also have dependencies on github) the bootstrap code gets out of hand very quickly and tends to be non-portable.</p>
<p>Creating separate libraries (rather than sharing one from your personal computer) will be important if the architecture differs (e.g., you run Windows but you want to run code on a Linux cluster).</p>
<p>The idea here is that <code>context</code> helps describe a context made from the above ingredients and then attempts to recreate it on a different computer (or in a different directory on your computer).</p>
<div id="contexts" class="section level2">
<h2>Contexts</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(context)
<span class="kw">context_log_start</span>()</code></pre>
<p>A simple context might look like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">ctx &lt;-<span class="st"> </span><span class="kw">save_context</span>(<span class="dt">packages=</span><span class="kw">c</span>(<span class="st">&quot;pkg1&quot;</span>, <span class="st">&quot;pkg2&quot;</span>), <span class="dt">sources=</span><span class="st">&quot;file.R&quot;</span>)
ctx</code></pre>
<pre><code>## &lt;context_handle&gt;
##  - id: f2325ff966da2430c20c8551340f6dc7
##  - root: /tmp/RtmpvonAoL</code></pre>
<p>This will save all the required metadata at the path <code>root</code> (by default within the temporary directory). The context information in this case is pretty simple:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_context</span>(ctx)</code></pre>
<pre><code>## &lt;context&gt;
##  - packages: list(attached = c(&quot;pkg1&quot;, &quot;pkg2&quot;), loaded = character(0))
##  - sources: file.R
##  - package_sources: list(cran = &quot;http://cran.rstudio.com&quot;, repos = NULL, github = NULL, bitbucket = NULL, local = NULL, use_local_drat = FALSE, expire = 1)
##  - auto: FALSE</code></pre>
<p>Even more simple, contexts can be made <em>automatically</em></p>
<pre class="sourceCode r"><code class="sourceCode r">ctx &lt;-<span class="st"> </span><span class="kw">save_context</span>(<span class="dt">auto=</span><span class="ot">TRUE</span>)
<span class="kw">read_context</span>(ctx)</code></pre>
<pre><code>## &lt;context&gt;
##  - packages: list(loaded = c(&quot;magrittr&quot;, &quot;formatR&quot;, &quot;codetools&quot;, &quot;stringi&quot;, &quot;knitr&quot;, &quot;stringr&quot;, &quot;evaluate&quot;), attached = &quot;context&quot;)
##  - global: 67476fb38df558e4acd0e6b7bad89282
##  - package_sources: list(cran = &quot;http://cran.rstudio.com&quot;, repos = NULL, github = NULL, bitbucket = NULL, local = NULL, use_local_drat = FALSE, expire = 1)
##  - auto: TRUE</code></pre>
<p>which will look at the packages you currently have attached and loaded, plus save a copy of all the objects in the global environment.</p>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<p>Once a context is defined, <em>tasks</em> can be defined in the context. These are simply R expressions associated with the identifier of a context.</p>
<pre class="sourceCode r"><code class="sourceCode r">ctx &lt;-<span class="st"> </span><span class="kw">save_context</span>(<span class="dt">auto=</span><span class="ot">TRUE</span>)
ctx$id</code></pre>
<pre><code>## [1] &quot;07ba0a797cceaf00ba09cad1ad352b93&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">save_task</span>(<span class="kw">quote</span>(<span class="kw">sin</span>(<span class="dv">1</span>)), <span class="dt">context=</span>ctx)
<span class="kw">read_task</span>(t)</code></pre>
<pre><code>## &lt;task&gt;
##  - expr: sin(1)
##  - context_id: 07ba0a797cceaf00ba09cad1ad352b93
##  - id: 58239d0ccf8e55994877cd1d66c07b48</code></pre>
<p>These tasks are loaded using the function <code>load_task</code> but this doesn’t need to be done manually often. Instead, to run this task, use the <code>run_task</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">run_task</span>(t)</code></pre>
<pre><code>## [ root      ]  /tmp/RtmpvonAoL
## [ task      ]  58239d0ccf8e55994877cd1d66c07b48
## [ context   ]  07ba0a797cceaf00ba09cad1ad352b93
## [ lib       ]  /tmp/RtmpvonAoL/R/x86_64-pc-linux-gnu/3.2
## [ library   ]  context
## [ namespace ]  magrittr, formatR, codetools, stringi, knitr, stringr, evaluate
## [ source    ]
## [ global    ]  2ba042de0af7b9932d6868d4f400e908
## [ expr      ]  sin(1)
## [ start     ]  2015-11-05 15:54:08.140
## [ result    ]  /tmp/RtmpvonAoL/results/58239d0ccf8e55994877cd1d66c07b48
## [ end       ]  2015-11-05 15:54:08.141</code></pre>
<p>This prints the result of restoring the context and running the task:</p>
<ul>
<li><code>root</code>: the directory within which all our context/task files will be located</li>
<li><code>id</code>: the task id</li>
<li><code>context</code>: the context id</li>
<li><code>lib</code>: A new library to install packages into (note that the path contains information about the system type and R version to increase the chance that packages will load successfully and not interfere with other environments).</li>
<li><code>library</code>: calls to <code>library()</code> to load packages and attach namespaces</li>
<li><code>namespace</code>: calls to <code>loadNamespace()</code>; these packages were present but not attached in the context.</li>
<li><code>source</code>: There was nothing to <code>source()</code> here so this is blank, otherwise it would be a list of filenames.</li>
<li><code>global</code>: Load a global environment</li>
<li><code>expr</code>: the expression to evaluate</li>
<li><code>start</code>: start time</li>
<li><code>result</code>: the filename that the result is written to</li>
<li><code>end</code>: end time</li>
</ul>
<p>After all that, here is the result:</p>
<pre class="sourceCode r"><code class="sourceCode r">res</code></pre>
<pre><code>## [1] 0.841471</code></pre>
<p>The result can also be retrieved using <code>task_result()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">task_result</span>(t)</code></pre>
<pre><code>## [1] 0.841471</code></pre>
<p>More ordinarily, this task will be run elsewhere (or perhaps by a second process on the same machine). To do this, first install the helper script (windows support coming soon):</p>
<pre class="sourceCode r"><code class="sourceCode r">context &lt;-<span class="st"> </span>context::<span class="kw">install_context</span>(<span class="kw">tempdir</span>())</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system2</span>(context, <span class="kw">c</span>(t$root, t$id))</code></pre>
<pre><code>## [ init      ]  2015-11-05 15:54:08.259
## [ version   ]  0.0.1
## [ root      ]  /tmp/RtmpvonAoL
## [ task      ]  58239d0ccf8e55994877cd1d66c07b48
## [ context   ]  07ba0a797cceaf00ba09cad1ad352b93
## [ lib       ]  /tmp/RtmpvonAoL/R/x86_64-pc-linux-gnu/3.2
## [ library   ]  context
## [ namespace ]  magrittr, formatR, codetools, stringi, knitr, stringr, evaluate
## [ source    ]
## [ global    ]  2ba042de0af7b9932d6868d4f400e908
## [ expr      ]  sin(1)
## [ start     ]  2015-11-05 15:54:08.336
## [ result    ]  /tmp/RtmpvonAoL/results/58239d0ccf8e55994877cd1d66c07b48
## [ end       ]  2015-11-05 15:54:08.337</code></pre>
<p>which looks rather like the above, but has the additional lines <code>init</code> and <code>version</code>. This is run in an entirely separate R process.</p>
<p>This is a bit fragile though as it requires that <code>context</code> is already installed on the target machine. So <code>context</code> also writes some bootstrap scripts that can set itself and its dependencies up.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system2</span>(<span class="kw">file.path</span>(t$root, <span class="st">&quot;context_runner&quot;</span>), <span class="kw">c</span>(t$root, t$id))</code></pre>
<pre><code>## args:
## /usr/lib/R/bin/exec/R, --slave, --no-restore, --file=/tmp/RtmpvonAoL/context_runner, --args, /tmp/RtmpvonAoL, 58239d0ccf8e55994877cd1d66c07b48
## [ bootstrap ]  /tmp/RtmpvonAoL
## [ lib       ]  /tmp/RtmpvonAoL/R/x86_64-pc-linux-gnu/3.2
## [ ok        ]
## [ init      ]  2015-11-05 15:54:08.454
## [ version   ]  0.0.1
## [ root      ]  /tmp/RtmpvonAoL
## [ task      ]  58239d0ccf8e55994877cd1d66c07b48
## [ context   ]  07ba0a797cceaf00ba09cad1ad352b93
## [ lib       ]  /tmp/RtmpvonAoL/R/x86_64-pc-linux-gnu/3.2
## [ library   ]  context
## [ namespace ]  magrittr, formatR, codetools, stringi, knitr, stringr, evaluate
## [ source    ]
## [ global    ]  2ba042de0af7b9932d6868d4f400e908
## [ expr      ]  sin(1)
## [ start     ]  2015-11-05 15:54:08.529
## [ result    ]  /tmp/RtmpvonAoL/results/58239d0ccf8e55994877cd1d66c07b48
## [ end       ]  2015-11-05 15:54:08.531</code></pre>
</div>
<div id="non-cran-packages" class="section level1">
<h1>Non-CRAN packages</h1>
<p>Especially in research code, which is in a state of flux or simply not widely useful enough to go on CRAN, packages will not be available on CRAN and therefore more complicated to install. The <code>devtools::install_github</code> function is great for interactive use, but especially when there is a set of interdependent packages that are not on CRAN it can be difficult to coordinate installation.</p>
<p>To get around this, <code>context</code> allows specifying package sources. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r">src &lt;-<span class="st"> </span><span class="kw">package_sources</span>(<span class="dt">github=</span><span class="kw">c</span>(<span class="st">&quot;traitecoevo/callr&quot;</span>,
                                <span class="st">&quot;richfitz/remake&quot;</span>,
                                <span class="st">&quot;richfitz/storr&quot;</span>))</code></pre>
<p>This can then be passed through to the <code>save_context</code> function above:</p>
<pre class="sourceCode r"><code class="sourceCode r">ctx &lt;-<span class="st"> </span><span class="kw">save_context</span>(<span class="dt">packages=</span><span class="st">&quot;remake&quot;</span>, <span class="dt">package_sources=</span>src)</code></pre>
<pre><code>## [ download  ]  traitecoevo/callr
## [ download  ]  richfitz/remake
## [ download  ]  richfitz/storr
## [ drat      ]  /tmp/RtmpvonAoL/drat</code></pre>
<p>This takes a little while (though subsequent calls to the same root will be faster) as it downloads the required packages from github and builds a local <code>drat</code> repository.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir</span>(<span class="kw">file.path</span>(<span class="kw">read_context</span>(ctx)$package_sources$local_drat, <span class="st">&quot;src&quot;</span>, <span class="st">&quot;contrib&quot;</span>))</code></pre>
<pre><code>## [1] &quot;callr_0.1.4.tar.gz&quot;  &quot;PACKAGES&quot;            &quot;PACKAGES.gz&quot;
## [4] &quot;remake_0.2.0.tar.gz&quot; &quot;storr_0.1.3.tar.gz&quot;</code></pre>
<p>This repository will be made available to the computer that runs the context.</p>
<p>An advantage of this approach over the <code>install_github</code> approach is that all the usual R install packages machinery works. In particular, the dependency resolution will occur automatically so the order of installation will be worked out for you.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
